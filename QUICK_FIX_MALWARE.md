# ‚ö° Quick Fix Malware & Downtime - Copy Paste

## üö® IMMEDIATE ACTION - Kill Malware!

```bash
# 1. Find and kill suspicious processes
sudo kill -9 $(ps aux | grep -E "p1eNsfx|curl.*tor2web" | grep -v grep | awk '{print $2}')

# 2. Verify they're gone
ps aux | grep -E "p1eNsfx|curl.*tor2web" | grep -v grep

# 3. Check for more
ps aux | awk '{print $11}' | sort | uniq -c | sort -rn | head -20
```

---

## üîß Restart All Services

```bash
# Restart everything
pm2 restart all && pm2 save && sudo systemctl restart nginx && sudo systemctl restart postgresql@16-main && sleep 5 && pm2 status
```

---

## ‚úÖ Verify Services

```bash
# Check PM2
pm2 status

# Test health endpoints
curl http://localhost:1234/health
curl http://localhost:5678/health

# Check services
sudo systemctl status nginx
sudo systemctl status postgresql@16-main
```

---

## üîç Check for More Malware

```bash
# Check all processes
ps aux --sort=-%cpu | head -20

# Check network connections
netstat -anp | grep ESTABLISHED | awk '{print $5}' | cut -d: -f1 | sort | uniq -c | sort -rn | head -10

# Check cron jobs
crontab -l
sudo crontab -l -u root
```

---

## üõ°Ô∏è Security Hardening

```bash
# Remove malware persistence
# Check startup scripts
ls -la /etc/rc.local
ls -la /etc/init.d/ | grep -E "p1eNsfx"

# Check .bashrc
cat ~/.bashrc | grep -E "curl|wget|p1eNsfx"

# Change passwords
passwd
```

---

## üìä All-in-One Investigation

```bash
# Run investigation script
chmod +x investigate-massive-downtime.sh
./investigate-massive-downtime.sh
```

---

**‚ö†Ô∏è PRIORITY: Kill malware processes FIRST!**
